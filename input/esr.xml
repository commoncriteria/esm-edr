<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/esr2html.xsl"?>

<ESR xmlns="http://common-criteria.rhcloud.com/ns/esr" name="Endpoint Detection Response(EDR)">
  
	<intro>
		<esrtitle>Endpoint Detection and Response (EDR)</esrtitle>
		<maintainer>NIAP</maintainer>
		<identifier>42</identifier>
		<version>1.0</version>
		<status>draft</status>
		<issuedate>March 05, 2018</issuedate>
		<approver/>
		<supercedes/>
	</intro>

	<section title="Background and Purpose" id="purpose">
		This document describes a core set of security requirements for Endpoint Detection and Response management servers.
		These requirements cover basic security characteristics and behaviors for management servers that are hosted in-cloud,
		on-premises, or a hybrid. EDR host agent security requirements are addressed in the ESM-HostAgent Protection Profile.
		Evaluation against the resulting EDR and ESM-HostAgent Protection Profile will ensure that a fundamental set of requirements is met. 
		<br/>
		The intent is that the remaining sections provide succinct statements that 
		highlight the relevant aspects to be addressed by the Technical 
		Community (TC) constructing the PP. Here, the authors provide a 
		narrative that introduces the reader to the problem being solved, 
		and presents key aspects that support or guide the TC, and may
		elaborate on subtleties not apparent in the “bulleted” high level
		statements.
	</section>
	<section title="Use Cases" id="usecases">
		The EDR management server collects data from endpoint devices to enable the detection and remediation of potentially
		malicious endpoint system activity.
		<ul>
			<li>Continuously records significant events occurring on managed systems.</li>
			<li>Automatically identifies, reports, and investigates potential malicious activity.</li>
			<li>Enables access through a management dashboard query interface.</li>
		</ul>
	</section>

	<section title="Resources to be protected" id="resourcesprotected">
    	<ul>
			<li>Sensitive data stored on the EDR management server.</li>
			<li>Credentials for authentication to or from the EDR management server.</li>
    		<li>Cryptographic key material used to perform secure communications with host agents.</li>
    		<li>Sensitive data in transit to or from the EDR management server.</li>
		</ul>
	</section>

	<section title="Attacker access" id="attackeraccess"> 
	<ul>
		<li>An attacker is assumed to attempt attacks from the following vantage points:
			<ul>
				<li>The network across which the application engages in communication, both actively
				and passively.</li>
				<li>The platform on which the application is installed, though as an unprivileged
				subject.</li>
			</ul>
		</li>
		<li>An attacker has an arbitrary amount of time to analyze the behavior of the application,
		its interaction with its host device or platform, and/or the data it transmits over the network.</li>
	</ul>
	</section>
	
	<section title="Essential Security Requirements" id="requirements">
		The following are the essential security requirements expected to be implemented by an
		EDR within the established scope.
		<ul>
			<!-- This is probably an SAR, and more on the Agent then the Server -->
			<li>The EDR Server shall not impair authorized system operations (e.g., updating, patching,
			scanning, business software usage) or native platform security mechanisms.</li>
			
			<li>The EDR shall ensure encryption of all data in transit between clients and between clients 
				and servers using TLS or DTLS
			</li>
			
			<li>The EDR Server shall encrypt at rest all endpoint collected data</li>
			
			<li>The EDR shall cryptograpically assure the integrity of all commends sent to EDR Agents</li>
			
			<li>The EDR Server shall store the following minimum set of endpoint collected
			parameters and events, including:
				<ul>
					<li>Basic system information to include Architecture, OS type and version, Host IP address</li>
					<li>All Privileged and unprivileged endpoint account login activity</li>
					<li>All process creation and termination</li>
					<li>All libraries and modules loaded by a process</li>
					<li>All network connection activity, including destination URLs, IPs</li>
					<li>All files created on persistant storage</li>
					<li>All new hardware devices added to system (this might be objective)</li>
					<li>All volitatile memory regions marked for execution that are not backed by 
						files on persistant storage (this might be objective)</li>					
				</ul>
			</li>
			
			<li>The EDR shall provide a visualization of an incident; include an incident timeline</li>
			
			<li>The EDR shall display an initial assessment of severity for an incident</li>
			
			<li>The EDR shall support Role Based Access Control for the delegation of the following minium roles:
				<ul>
					<li>Administrator, someone who fully exersize all features of the EDR</li>
					<li>SOC Analyst, someone who can invesitate an incent and close incidents</li>
					<li>Read Only, someone who can only read data and cannot make any changes</li>
				</ul>
			</li>
			
			<li>The EDR shall provide response and isolation capabilities, including at a minimum:
				<ul>
					<li>Endpoint network quarantine and isolation</li>
					<li>Endpoint Process termination</li>
					<li>Retrieval of Endpoint Files (malicious artifact capture)</li>
				</ul>
			</li>
			
			<li>The EDR shall provide an API or a data export mechanism using standards based formats (e.g., STIX)
				for intgration into custom or third-party reporting software</li>
			
			<li>The EDR shall provide a configuration option for the retention period of collected data</li>
		
		</ul>
	</section>

	<section title="Assumptions" id="assumptions">
		Simply put, this section presents the aspects of the product and 
		its	intended environment that can be assumed to hold true. This 
		will provide additional scope on the resulting PP.

		The following assumptions are made for the operating system product and its operational
		environment:
		<ul>
			<li>The underlying platform is physically protected, to a large extent. The hardware
				that the product manages is secured by defensive measures that make physical attacks
				impractical for most attackers. At the same time, casual passersby might attempt to
				trivially access the system. </li>
			<li>The product implements some security-relevant functionality that does not require
				evaluation (e.g., network time synchronization, process scheduling, and virtual
				memory management including process separation). </li>
			<li>Depending on configuration and capability, the product may or may not be: <ul>
					<li>configuration-managed by the enterprise</li>
					<li>bound to directory services to support multi-user login</li> </ul>
			</li>
			<li> The product runs application software developed by a third-party. The applications are
				not intentionally developed to be malicious, but can contain inadvertent coding
				errors. These errors introduce risk that control of an application may be seized by
				a malicious entity. The product shall confine these applications within the originally
				designated operating environment. </li>
			<li>The platform is connected to a network. For purposes of sending/receiving data, to
				include software updates, the platform is connected to other entities. Other
				entities on the network are not inherently trustable. </li>
			<li>Administrators are not malicious in nature.</li>
			<li> Users are not malicious in nature, though they may inadvertently or intentionally engage in risky behavior. </li>
		</ul>
	</section>


	<section title="Objective Requirements" id="objective">
			<li>
				The EDR shall provide an automated remediation activities when configured to do so.
			</li>
	</section>

	<section title="Optional Extensions" id="extensions"> 
		<ul>
			<li>
				Client authentication to endpoint agents using X.509v3 certificates.
			</li>
		</ul>
	</section>

	<section title="Outside the TOE's Scope" id="outsidescope">
		The following list contains items that are explicitly out-of-scope for any evaluation
		against the product PP <ul>
			<li>The hardware or firmware of the underlying platforms.</li>
			<li>The host operating system of the endpoint.</li>
		</ul>
	</section>
</ESR>
