<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/esr2html.xsl"?>

<ESR xmlns="http://common-criteria.rhcloud.com/ns/esr" name="Endpoint Detection Response(EDR)">
  
	<intro>
		<esrtitle>Endpoint Detection and Response (EDR)</esrtitle>
		<maintainer>NIAP</maintainer>
		<identifier>42</identifier>
		<version>1.0</version>
		<status>draft</status>
		<issuedate>March 05, 2018</issuedate>
		<approver/>
		<supercedes/>
	</intro>

	<section title="Background and Purpose" id="purpose">
		This document describes a core set of security requirements for Endpoint Detection and Response management servers.
		These requirements cover basic security characteristics and behaviors for management servers that are hosted in-cloud,
		on-premises, or a hybrid. EDR host agent security requirements are addressed in the ESM-HostAgent Protection Profile.
		Evaluation against the resulting EDR and ESM-HostAgent Protection Profile will ensure that a fundamental set of requirements is met. 
		<br/>
		The intent is that the remaining sections provide succinct statements that highlight the relevant aspects to be
		addressed by the Technical Community (TC) constructing the PP. Here, the authors provide a narrative that introduces
		the reader to the problem being solved, and presents key aspects that support or guide the TC, and may elaborate on
		subtleties not apparent in the “bulleted” high level statements.
	</section>
	<section title="Use Cases" id="usecases">
		The EDR management server collects data from endpoint devices to enable the detection and remediation of potentially
		malicious endpoint system activity.
		<ul>
			<li>Continuously records significant events occurring on managed systems.</li>
			<li>Automatically identifies, reports, and investigates potential malicious activity.</li>
			<li>Enables access through a management dashboard query interface.</li>
		</ul>
	</section>

	<section title="Resources to be protected" id="resourcesprotected">
    	<ul>
			<li>Sensitive data stored on the EDR management server.</li>
			<li>Credentials for authentication to or from the EDR management server.</li>
    		<li>Cryptographic key material used to perform secure communications with host agents.</li>
    		<li>Sensitive data in transit to or from the EDR management server.</li>
		</ul>
	</section>

	<section title="Attacker access" id="attackeraccess"> 
	<ul>
		<li>An attacker is assumed to attempt attacks from the following vantage points:
			<ul>
				<li>The network across which the application engages in communication, both actively
				and passively.</li>
				<li>The platform on which the application is installed, though as an unprivileged
				subject.</li>
			</ul>
		</li>
		<li>An attacker has an arbitrary amount of time to analyze the behavior of the application,
		its interaction with its host device or platform, and/or the data it transmits over the network.</li>
	</ul>
	</section>
	
	<section title="Essential Security Requirements" id="requirements">
		The following are the essential security requirements expected to be implemented by an EDR management server
		within the established scope.
		<ul>
			<li>The EDR management server shall use good crypto (hasing, signing, etc)</li>
			<li>The EDR management server shall ensure encryption of all data in transit between endpoint agent and EDR server using TLS.</li>
			<li>THe EDR management server shell use secure TLS/HTTPS connections to the management dashboard</li>
			<li>The EDR management server or underling platform shall encrypt all persistently stored data collected from endpoints</li>
			<li>The EDR management server shall cryptograpically assure the integrity of all commands sent to host agents.</li>
			<li>The EDR management server shall collect and store a minimum set of parameters and events
			from endpoint systems, including:
				<ul>
					<li>Endpoint system architecture, operating system version, internal/external host IP addresses</li>
					<li>All privileged and unprivileged endpoint account login activity</li>
					<li>All process creation and termination</li>
					<li>All libraries and modules loaded by processes</li>
					<li>All network connection activity, including destination URLs, IPs</li>
					<li>All files created on persistant storage</li>
					<li>All new hardware devices added to system (this might be an objective)</li>
					<li>All volatile memory regions marked for execution running processes not backed by 
						executable files on persistant storage (this might be an objective)</li>					
				</ul>
			</li>
			<li>The EDR management server shall provide a visualization of an incident; include an incident timeline</li>
			<li>The EDR management server shall display an initial assessment of severity for an incident</li>
			<li>The EDR management server shall support Role Based Access Control 
				for the delegation of, at least, the following roles:
				<ul>
					<li>Administrator, or someone who fully exercises all EDR features</li>
					<li>SOC Analyst, or someone who can investigate, remediate, and close incidents</li>
					<li>Read Only, or someone who can only read data and cannot make any changes</li>
				</ul>
			</li>
			<li>The EDR management server shall provide response and isolation capabilities, including at a minimum:
				<ul>
					<li>Endpoint network quarantine and isolation</li>
					<li>Endpoint process termination</li>
					<li>Retrieval of endpoint files (malicious artifact capture)</li>
				</ul>
			</li>
			<li>The EDR management server shall provide an API or a data export mechanism using standards based formats
			(e.g., STIX) for integration into custom or third-party reporting software.</li>
			<li>The EDR management server shall provide a retention period configuration option for collected data.</li>
			<li>The EDR management server shall implement a minimum set of modern anti-exploitation features, including:
				<ul>
					<li>Address Space Layer Randomization (ASLR)</li>
					<li>Stack Canaries/Cookies</li>
					<li>Data Execution Protection (DEP)</li>
					<li>CSRF Tokens to protect itself</li>
				</ul>
			</li>
		</ul>
	</section>

	<section title="Assumptions" id="assumptions">
		Simply put, this section presents the aspects of the product and its intended environment that
		can be assumed to hold true. This will provide additional scope on the resulting protection profile.
		<br/>
		The following assumptions are made for the operating system product and its operational
		environment:
		<ul>
			<li>The underlying platform is physically protected, to a large extent. The hardware
				that the product manages is secured by defensive measures that make physical attacks
				impractical for most attackers. At the same time, casual passersby might attempt to
				trivially access the system.</li>
			<li>The product implements some security-relevant functionality that does not require
				evaluation (e.g., network time synchronization, process scheduling, and virtual
				memory management including process separation).</li>
			<li>Depending on configuration and capability, the product may or may not be:
				<ul>
					<li>Configuration-managed by the enterprise</li>
					<li>Bound to directory services to support multi-user login</li>
				</ul>
			</li>
			<li>The product runs application software developed by a third-party. The applications are
				not intentionally developed to be malicious, but can contain inadvertent coding
				errors. These errors introduce risk that control of an application may be seized by
				a malicious entity. The product shall confine these applications within the originally
				designated operating environment.</li>
			<li>The platform is connected to a network. For purposes of sending/receiving data, to
				include software updates, the platform is connected to other entities. Other
				entities on the network are not inherently trustable. </li>
			<li>Administrators are not malicious in nature.</li>
			<li>Users are not malicious in nature, though they may inadvertently or intentionally engage in risky behavior.</li>
		</ul>
	</section>

	<section title="Objective Requirements" id="objective">
		<ul>
			<li>
				The EDR shall provide an automated remediation activities when configured to do so.
			</li>
		</ul>
	</section>

	<section title="Optional Extensions" id="extensions"> 
		<ul>
			<li>
				Client authentication to endpoint agents using X.509v3 certificates.
			</li>
		</ul>
	</section>

	<section title="Outside the TOE's Scope" id="outsidescope">
		The following list contains items that are explicitly out-of-scope for any evaluation
		against the product protection profile.
		<ul>
			<li>The hardware or firmware of the underlying platforms</li>
			<li>The host operating system of the EDR management server</li>
			<li>The underlying web server used by the EDR management server</li>		
		</ul>
	</section>
</ESR>
